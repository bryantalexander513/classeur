<div class="explorer background panel">

    <div class="explorer container panel">
        <div class="header">
            <div layout="row" layout-align="space-between end">
                <md-button class="classeur selector" ng-click="explorerLayoutSvc.toggleExplorer()">
                    <div layout="row" layout-align="start end">
                        <div class="logo no-overflow">
                            <img src="bower_components/classets/images/logo.png" height="60">
                        </div>
                        <div class="no-overflow" flex>
                            {{explorerLayoutSvc.currentClasseurDao.name}}
                        </div>
                        <div class="toggle icon">
                            <span class="icon-keyboard-arrow-down"></span>
                        </div>
                    </div>
                </md-button>
                <div class="links" flex>
                    <md-button class="md-primary" ng-click="setDocFile('markdownCheatSheet')">
                        <span class="icon-help"></span> Help
                    </md-button>
                    <md-button class="md-primary" ng-click="setDocFile('markdownCheatSheet')">
                        <span class="icon-help"></span> Markdown Cheat Sheet
                    </md-button>
                </div>
            </div>
            <div layout="row" layout-align="end start">
                <div ng-if="!socketSvc.hasToken">
                    <md-button ng-click="signin()">
                        Sign in with Google <span class="icon-arrow-forward"></span>
                    </md-button>
                </div>
                <div ng-if="userSvc.user">
                    <span class="username">Hi <b>{{userSvc.user.name}}</b></span>
                    </span>
                    <md-button>
                        Go premium <span class="icon-arrow-forward"></span>
                    </md-button>
                </div>
            </div>
        </div>
        <div class="classeur list panel no-overflow">
            <div class="scroller panel">
                <div class="tile container" ng-repeat="classeur in classeurSvc.classeurs">
                    <cl-classeur-entry></cl-classeur-entry>
                </div>
                <div class="tile container">
                    <div class="new tile content panel md-whiteframe-z1" ng-class="'plastic-' + ((classeurSvc.classeurs.length) % 4)" ng-click="createClasseur()">
                        <div class="tab-1" ng-class="'plastic-' + ((classeurSvc.classeurs.length + 1) % 4)"></div>
                        <div class="tab-2" ng-class="'plastic-' + ((classeurSvc.classeurs.length + 2) % 4)"></div>
                        <div class="footer panel" layout="row" layout-align="center">
                            <cl-button class="btn">
                                <a class="icon-add" ng-click="createClasseur()" aria-label="Create classeur" title="Create classeur"></a>
                            </cl-button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="menu panel background">
            <div>
                <md-button class="md-primary"><span class="icon-keyboard-arrow-right"></span> Settings</md-button>
                <md-button class="md-primary" ng-click="userSvc.signout()" ng-if="socketSvc.hasToken"><span class="icon-keyboard-arrow-right"></span> Signout</md-button>
            </div>
            <div>
                <md-button><span class="icon-keyboard-arrow-right"></span> Privacy Policy</md-button>
                <md-button><span class="icon-keyboard-arrow-right"></span> Terms</md-button>
            </div>
        </div>

        <div class="explorer content panel md-whiteframe-z2" ng-class="plasticClass">

            <div class="hole panel background first"></div>
            <div class="hole panel background second"></div>

            <div class="folder scroller panel">

                <div class="folder container" ng-switch="!!explorerLayoutSvc.currentFolderDao">

                    <div class="nav" layout="row" ng-switch-when="true" layout-align="center center">
                        <div class="folder btn icon-publ" ng-show="explorerLayoutSvc.currentFolderDao.userId"></div>
                        <md-input-container md-theme="classeur" flex>
                            <input ng-model="explorerLayoutSvc.currentFolderDao.name" class="folder name" ng-disabled="explorerLayoutSvc.currentFolderDao === explorerLayoutSvc.unclassifiedFolder" ng-blur="folderNameModified()">
                        </md-input-container>

                        <div ng-if="explorerLayoutSvc.currentFolderDao !== explorerLayoutSvc.unclassifiedFolder" layout="row">
                            <md-button ng-if="socketSvc.hasToken" class="share folder btn" md-no-ink>
                                <a class="icon-share" ng-class="{red: explorerLayoutSvc.currentFolderDao.effectiveSharing === 'rw', blue: explorerLayoutSvc.currentFolderDao.effectiveSharing === 'r'}" ng-click="explorerLayoutSvc.sharingDialogFolderDao = explorerLayoutSvc.currentFolderDao" aria-label="Share folder" title="Share folder"></a>
                            </md-button>
                            <md-button class="delete folder btn" md-no-ink>
                                <a class="icon-delete" ng-click="deleteConfirm(true)" title="Delete folder" aria-label="Delete folder"></a>
                            </md-button>
                        </div>
                    </div>

                    <div class="nav" layout="row" layout-align="center center" ng-switch-when="false">
                        <md-input-container md-theme="classeur" flex>
                            <input class="folder name" value="Available offline" disabled>
                        </md-input-container>
                    </div>

                    <div class="new-file actions" layout="row" layout-align="end">
                        <md-button ng-click="createFile()">
                            <span class="icon-add"></span> New file
                        </md-button>
                        <md-button>
                            <span class="icon-add"></span> Import
                        </md-button>
                    </div>

                    <div class="folder content" ng-if="explorerLayoutSvc.files.length">

                        <div class="file actions" ng-switch="hasSelection()">
                            <div ng-switch-when="false">
                                <md-button md-no-ink class="md-primary" ng-click="selectAll()">
                                    <span class="icon-check"></span> Select all
                                </md-button>
                            </div>
                            <div ng-switch-when="true">
                                <md-button md-no-ink class="md-primary" ng-click="selectNone()">
                                    <span class="icon-check-box-outline-blank"></span> Select None
                                </md-button>
                            </div>
                            <div ng-switch-when="true">
                                <md-button md-no-ink class="md-primary" ng-click="deleteConfirm()">
                                    <span class="icon-delete"></span> Delete
                                </md-button>
                            </div>
                        </div>

                        <cl-file-entry ng-repeat="fileDao in explorerLayoutSvc.files"></cl-file-entry>
                        
                        <md-progress-circular md-mode="indeterminate" ng-if="explorerLayoutSvc.currentFolderDao.userId && !explorerLayoutSvc.currentFolderDao.lastRefresh"></md-progress-circular>

                        <cl-recent-alert ng-if="!explorerLayoutSvc.currentFolderDao"></cl-recent-alert>

                    </div>

                </div>
            </div>

            <div class="btn-grp panel background no-overflow">
                <div class="container panel">
                    <div cl-folder-button cl-file-dragging-target class="folder btn btn-panel" ng-repeat="folderDao in explorerLayoutSvc.folders" ng-class="'plastic-' + (($index + 1) % 4)">
                        <md-button ng-click="setFolder(folderDao)" aria-label="{{folder.name}}">
                            <div class="rotate-90" ng-if="folderDao !== explorerLayoutSvc.createFolder">
                                {{folderDao.name}}
                            </div>
                            <div class="icon-add" ng-if="folderDao === explorerLayoutSvc.createFolder"></div>
                        </md-button>
                    </div>
                </div>
                <div class="current folder btn btn-panel plastic" ng-class="plasticClass">
                    <md-button aria-label="{{explorerLayoutSvc.currentFolderDao.name}}">
                        <div class="rotate-90">{{explorerLayoutSvc.currentFolderDao.name}}</div>
                    </md-button>
                </div>
                <div cl-folder-button class="recent btn btn-panel plastic" ng-class="{open: !explorerLayoutSvc.currentFolderDao}">
                    <md-button ng-click="setFolder()" aria-label="Recent">
                        <div class="rotate-90">Recent</div>
                    </md-button>
                </div>
                <div class="shadow panel"></div>
            </div>
        </div>
    </div>

    <cl-file-dragging></cl-file-dragging>
</div>

<cl-sharing-dialog></cl-sharing-dialog>
